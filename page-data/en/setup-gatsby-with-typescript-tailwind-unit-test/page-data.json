{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/en/setup-gatsby-with-typescript-tailwind-unit-test","result":{"data":{"allGithubData":{"nodes":[{"data":{"viewer":{"avatarUrl":"https://avatars.githubusercontent.com/u/19237948?u=05c87da55840481725a97a153f1380f2acf98dea&v=4","email":"dinhhai281@gmail.com","name":"Hai Nguyen","login":"dinhhai281"}}}]},"markdownRemark":{"html":"<p><em>GatsbyJS</em> là một framework dựa trên ReactJS vàn GraphQL, phù hợp để xây dựng những ứng dụng web một cách nhanh cùng với hiệu năng vượt trội. Bài viết này sẽ nói về cách mình setup một project <code class=\"language-text\">GatsbyJS</code>. Cụ thể là một template <code class=\"language-text\">GatsbyJS</code> sử dụng <code class=\"language-text\">Typescript</code>, <code class=\"language-text\">TailwindCSS (PostCSS)</code> và <code class=\"language-text\">Unit Testing</code>.</p>\n<h4>Cài đặt những thứ cần thiết</h4>\n<p>Trước khi bắt đầu bạn cần cài đặt</p>\n<ul>\n<li>Node.js</li>\n<li>Git</li>\n<li>Gatsby CLI</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> i -g gatsby-cli</code></pre></div>\n<h4>Dùng Gatsby CLI để tạo 1 project GatsbyJS</h4>\n<p>Với Gatsby CLI, chỉ cần một câu lệnh là công việc này sẽ hoàn thành.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">gatsby new gatsby-typescript-tailwindcss https://github.com/gatsbyjs/gatsby-starter-hello-world</code></pre></div>\n<p>Với câu lệnh trên, bạn sẽ tạo ra một thư mục <code class=\"language-text\">gatsby-typescript-tailwindcss</code> với <code class=\"language-text\">gatsby-starter-hello-world</code> template. Gatsby có rất nhiều template được cộng đồng xây dựng bạn có thể tìm kiếm ở <a href=\"https://www.gatsbyjs.org/starters/?v=2\">đây</a>.</p>\n<p>Mình cũng có tạo 1 template là thành quả của bài viết này nếu muốn dùng mà không muốn đọc hết thì tìm trong github của mình nhé 😘.</p>\n<p>Quay lại, sử dụng <code class=\"language-text\">gatsby-starter-hello-world</code> bạn sẽ có một project gatsby không có bất kỳ plugin nào. Vì mục đích là để làm blog nên sau này chỉ thêm những plugin cần thiết cho việc đó thôi. Trên trang chủ của GatsbyJS bạn cũng có thể tìm được một cái template starter dùng cho viết blog đó 😋.</p>\n<h4>Setup Typescript</h4>\n<p>GatsbyJS hiện tại có hỗ trợ phần nào cho Typescript, chỉ cần đổi extension của file từ <code class=\"language-text\">.js</code> sang <code class=\"language-text\">.tsx</code> là được. Tuy nhiên với những file như <code class=\"language-text\">gatsby-config.js</code>, <code class=\"language-text\">gatsby-brower.js</code>, <code class=\"language-text\">gatsby-node.js</code> thì không dùng Typescirpt được nhé.</p>\n<p>Nhớ tạo file <code class=\"language-text\">tsconfig.json nhé</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"CommonJS\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ESNext\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"DOM\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ESNext\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"jsx\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"preserve\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"esModuleInterop\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"strict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noEmit\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noUnusedLocals\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"exclude\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"node_modules\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"public\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\".cache\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Mình thì có dùng Alias Import của Typescript nên cần phải cài thêm <code class=\"language-text\">tsconfig-paths-webpack-plugin</code></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> i -D tsconfig-paths-webpack-plugin</code></pre></div>\n<p>Sau đó, thêm vào update lại file gatsby-node.js</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> TsConfigPathsPlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tsconfig-paths-webpack-plugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onCreateWebpackConfig</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> actions <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  actions<span class=\"token punctuation\">.</span><span class=\"token function\">setWebpackConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    resolve<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">TsConfigPathsPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Bây giờ update lại file <code class=\"language-text\">tsconfig.json</code> để thêm alias, trong trường hợp của mình thì thêm 2 cái này</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"CommonJS\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ESNext\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"DOM\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ESNext\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"jsx\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"preserve\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"esModuleInterop\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"strict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noEmit\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"noUnusedLocals\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Thêm @components/* và @utils/*</span>\n    <span class=\"token property\">\"baseUrl\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"src\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"paths\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"@utils/*\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"./utils/*\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"@components/*\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"./components/*\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"exclude\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"node_modules\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"public\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\".cache\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Sau khi thêm xong thì thay vì</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> Layout <span class=\"token keyword\">from</span> <span class=\"token string\">'../../../components/layout.tsx'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>thì ở bất cứ thư mục nào chỉ cần</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> Layout <span class=\"token keyword\">from</span> <span class=\"token string\">'@components/layout.tsx'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<h4>Setup TailwindCSS</h4>\n<p><code class=\"language-text\">TailwindCSS</code> là một CSS framework mà mình khá thích và dạo gần đây cũng thích style Atomic CSS. Nếu bạn không thích thì có thể dùng <code class=\"language-text\">styled-component</code>/<code class=\"language-text\">emotion</code> hay SASS tuỳ thích nhé.</p>\n<p>Để setup <code class=\"language-text\">TailwindCSS</code> thì đầu tiên bạn phải cài PostCSS. Gatsby có sẵn <code class=\"language-text\">gatsby-plugin-postcss</code> luôn.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> i tailwindcss gatsby-plugin-postcss cssnano autoprefixer postcss-import</code></pre></div>\n<p>Giải thích một chút về những thứ bạn vừa cài:</p>\n<ul>\n<li><code class=\"language-text\">cssnano</code> là một plugin của <code class=\"language-text\">postcss</code> dùng để minified css giúp cho bundle size của bạn nhỏ hơn, đối với việc build ra static file như GatsbyJS thì bundle càng nhỏ càng tốt đúng không 😉</li>\n<li><code class=\"language-text\">autoprefixer</code> là một plugin của <code class=\"language-text\">postcss</code> sẽ tự động thêm các prefix để code css của bạn chạy được trên các browser khác nhau.</li>\n<li><code class=\"language-text\">postcss-import</code> là một plugin của <code class=\"language-text\">postcss</code> hỗ trợ syntax <code class=\"language-text\">@import</code>.</li>\n<li><code class=\"language-text\">tailwindcss</code> nhân vật chính, thật ra nó cũng là 1 plugin của <code class=\"language-text\">postcss</code> 😬.</li>\n</ul>\n<p>Đầu tiên thêm mở file <code class=\"language-text\">gatsby-config.js</code> lên thêm plugin postcss vô.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'gatsby-plugin-postcss'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Bây giờ tạo file <code class=\"language-text\">tailwind.config.js</code> với nội dung như sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  purge<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'./src/**/*.tsx'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  theme<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  variants<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Cơ bản thế này là đủ. Tuy nhiên để biết cụ thể bạn có thể làm gì trong file config này thì nên đọc document của TailwindCSS nhé. Ở đây mình có config để dùng <code class=\"language-text\">PurgeCSS</code> trên những file <code class=\"language-text\">.tsx</code>, việc này sẽ loại bỏ những utility class bạn không sử dụng ra khỏi bundle giúp nó nhỏ hơn.</p>\n<p>Cuối cùng tạo file <code class=\"language-text\">postcss.config.js</code> nữa là xong cho TailwindCSS</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> tailwindConfig <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./tailwind.config'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'postcss-import'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tailwindcss'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>tailwindConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'postcss-nested'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'autoprefixer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">...</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">===</span> <span class=\"token string\">'production'</span> <span class=\"token operator\">?</span> <span class=\"token punctuation\">[</span><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cssnano'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Về cơ bản là file này để gắn mấy cái plugin của <code class=\"language-text\">PostCSS</code> thôi. Giờ thì bạn đã sẵn sàng để sử dụng TailwindCSS rồi đó. Để bắt đầu thì hãy tạo file <code class=\"language-text\">src/css/style.css</code> với nội dung sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@import</span> <span class=\"token string\">'tailwindcss/base'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token atrule\"><span class=\"token rule\">@import</span> <span class=\"token string\">'tailwindcss/components'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token atrule\"><span class=\"token rule\">@import</span> <span class=\"token string\">'tailwindcss/utilities'</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>Sau đó trong file <code class=\"language-text\">gatsby-browser.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token string\">'./src/css/style.css'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4>Setup ESLint</h4>\n<p>Hiện tại TSLint đã bị deprecated nên mình sẽ dùng ESLint cho hợp thời nhé. Đầu tiên là cài những package sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> i -D eslint eslint-config-prettier eslint-plugin-prettier eslint-plugin-react @typescript-eslint/eslint-plugin @typescript-eslint/parser prettier</code></pre></div>\n<p>Tạo file <code class=\"language-text\">.eslintrc</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"parser\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@typescript-eslint/parser\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"extends\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"eslint:recommended\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"plugin:react/recommended\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"plugin:@typescript-eslint/recommended\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"prettier/@typescript-eslint\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"plugin:prettier/recommended\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"settings\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"react\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"detect\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"env\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"browser\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"node\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"es6\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"@typescript-eslint\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"react\"</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"parserOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"ecmaFeatures\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"jsx\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"ecmaVersion\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2020</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sourceType\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"module\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"rules\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"react/prop-types\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"off\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"@typescript-eslint/explicit-function-return-type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"off\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"overrides\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"files\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"*.ts\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"*.js\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"*.tsx\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"*.jsx\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"rules\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"@typescript-eslint/no-var-requires\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"off\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"@typescript-eslint/explicit-module-boundary-types\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"off\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span> </code></pre></div>\n<p>Tạo file <code class=\"language-text\">.prettierrc</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"arrowParens\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"avoid\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"semi\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"singleQuote\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"jsxSingleQuote\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"bracketSpacing\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"trailingComma\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"es5\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"printWidth\"</span><span class=\"token operator\">:</span> <span class=\"token number\">120</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"endOfLine\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"lf\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Nếu muốn tự dộng fix lint khi save file thì hãy tạo file <code class=\"language-text\">.vscode/settings.json</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"editor.codeActionsOnSave\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"source.fixAll.eslint\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>Cuối cùng là Unit Test</h4>\n<p>Thật ra để làm blog thì phần này không cần thiết đâu, nhưng mà mục đích của cái template này có thể làm gì cũng được nên mình sẽ thêm phần setup unit test nữa.</p>\n<p>Ở đây mình sẽ dùng <code class=\"language-text\">Jest</code> và <code class=\"language-text\">@testing-library/react</code>. Đầu tiên là cài đặt một số thứ:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> i -D @babel/preset-typescript @testing-library/react jest @types/jest babel-jest identity-obj-proxy</code></pre></div>\n<p>File <code class=\"language-text\">jest-preprocess.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> babelOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  presets<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'babel-preset-gatsby'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'@babel/preset-typescript'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'babel-jest'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">createTransformer</span><span class=\"token punctuation\">(</span>babelOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>File <code class=\"language-text\">loadershim.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">global<span class=\"token punctuation\">.</span>___loader <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  enqueue<span class=\"token operator\">:</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>File <code class=\"language-text\">jest.config.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  transform<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'^.+\\\\.[jt]sx?$'</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;rootDir>/jest-preprocess.js</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  moduleNameMapper<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'.+\\\\.(css|styl|less|sass|scss)$'</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">identity-obj-proxy</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'.+\\\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$'</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;rootDir>/__mocks__/file-mock.js</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'@utils/(.*)'</span><span class=\"token operator\">:</span> <span class=\"token string\">'&lt;rootDir>/src/utils/$1'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'@components/(.*)'</span><span class=\"token operator\">:</span> <span class=\"token string\">'&lt;rootDir>/src/components/$1'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'@pages/(.*)'</span><span class=\"token operator\">:</span> <span class=\"token string\">'&lt;rootDir>/src/pages/$1'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'@templates/(.*)'</span><span class=\"token operator\">:</span> <span class=\"token string\">'&lt;rootDir>/src/templates/$1'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  testPathIgnorePatterns<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">node_modules</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\\\\.cache</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;rootDir>.*/public</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  transformIgnorePatterns<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">node_modules/(?!(gatsby)/)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  globals<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    __PATH_PREFIX__<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    __BASE_PATH__<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  testURL<span class=\"token operator\">:</span> <span class=\"token string\">'http://localhost'</span><span class=\"token punctuation\">,</span>\n  moduleDirectories<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'node_modules'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'__dirname'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'src'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  setupFiles<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;rootDir>/loadershim.js</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Trong file trên thì mình sẽ dùng package <code class=\"language-text\">identity-obj-proxy</code> để mock các file css, scss... File binary thì <code class=\"language-text\">__mocks__/file-mock.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token string\">'test-file-stub'</span><span class=\"token punctuation\">;</span> </code></pre></div>\n<p>Mock thêm Gatsby nữa <code class=\"language-text\">__mocks__/gatsby.ts</code></p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> gastby <span class=\"token operator\">=</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">requireActual</span><span class=\"token punctuation\">(</span><span class=\"token string\">'gatsby'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">module</span><span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>gastby<span class=\"token punctuation\">,</span>\n  graphql<span class=\"token operator\">:</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  Link<span class=\"token operator\">:</span> jest\n    <span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">mockImplementation</span><span class=\"token punctuation\">(</span>\n      <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> activeClassName<span class=\"token punctuation\">,</span> activeStyle<span class=\"token punctuation\">,</span> getProps<span class=\"token punctuation\">,</span> innerRef<span class=\"token punctuation\">,</span> partiallyActive<span class=\"token punctuation\">,</span> ref<span class=\"token punctuation\">,</span> replace<span class=\"token punctuation\">,</span> to<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>rest <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n        React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>rest<span class=\"token punctuation\">,</span> href<span class=\"token operator\">:</span> to <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  StaticQuery<span class=\"token operator\">:</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  useStaticQuery<span class=\"token operator\">:</span> jest<span class=\"token punctuation\">.</span><span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4>Lúc làm thì mò lâu lắm, viết lại có thể sẽ có chút sai sót bữa nào rảnh sẽ test lại cái bài viết này 😵</h4>","frontmatter":{"path":"/setup-gatsby-with-typescript-tailwind-unit-test","title":"Cách dựng một trang blog với GatsbyJS + Typescript + TailwindCSS","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmUlEQVQoz32SS0sCURTH7+epKKJc9AnqI0Qbo5cR2K5dRG1bTpmlUZkuKiEbqaGs7OFrLHNsQh0dUygjCzRLLO88uzNjUEgeLofDvfzP+fG/Bxi6V0Y6lyd6Vj3226tDliTSnx9QlmVJkpsEBwXKmwMGnUXfurg+46XOcpe7iadMUVX+K9Ve7umCf48Bg22muX5n5DgTwJl46EGTofRTSL8baXXxuRJwM2GCBQj42EFfH2UU4ArkIP+SfxMFRSOKYuNkHgrR02xoPxV0M2Bj9hzR+1x1YM92ZHpg7QKnUyxDRSlWDZIkC4UChFAD9rmSUW8WMxKAVHvEg3Vgz05k3rjlc9NR6sZm2zSbzU6nE8Mwq9UKuVr5tRrAkzcnWddCeLRzGYQO0gi4+lHTqCrlz1TsEX7xiJnnlYyaoqJUKgmcqAKng+7UVK99qH0J+PeSebbY+Dd/fVJy9g4BJ2JnOWyS0LeYxnUWoDr8WyRLotT4N4rDOIMmuxbDwx3msa4VdED1vdZsJdR7nkMroTiMMKf6HAjY0G1B4m/2qf1XjUWRzQAAAABJRU5ErkJggg==","aspectRatio":2,"src":"/next-blog/static/35e7cf2fa052510072e95a9d133e49a4/05d05/gatsby-featured.png","srcSet":"/next-blog/static/35e7cf2fa052510072e95a9d133e49a4/5ca18/gatsby-featured.png 270w,\n/next-blog/static/35e7cf2fa052510072e95a9d133e49a4/13528/gatsby-featured.png 540w,\n/next-blog/static/35e7cf2fa052510072e95a9d133e49a4/05d05/gatsby-featured.png 1080w,\n/next-blog/static/35e7cf2fa052510072e95a9d133e49a4/0dadc/gatsby-featured.png 1500w","sizes":"(max-width: 1080px) 100vw, 1080px"}}},"date":"2020-07-25","tags":"TYPESCRIPT,REACT,CSS","duration":12}}},"pageContext":{"mdpath":"/setup-gatsby-with-typescript-tailwind-unit-test","language":"en","intl":{"language":"en","languages":["en","vi"],"messages":{"home.greeting":"Hello, I'm Hai Dinh Nguyen","home.intro":"I'm a Software Engineer. I mostly do front-end development. I can work well with React and Angular, also a big fan of Functional Programming and Reactive Programming."},"routed":true,"originalPath":"/setup-gatsby-with-typescript-tailwind-unit-test","redirect":true,"defaultLanguage":"en"}}},"staticQueryHashes":["4033596395"]}