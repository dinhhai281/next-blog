{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/cool-react-routing.md","result":{"data":{"allGithubData":{"nodes":[{"data":{"viewer":{"avatarUrl":"https://avatars.githubusercontent.com/u/19237948?u=05c87da55840481725a97a153f1380f2acf98dea&v=4","email":"dinhhai281@gmail.com","name":"Hai Nguyen","login":"haidnguyen"}}}]},"markdownRemark":{"html":"<p>Routing chắc là cái basic nhất khi xây dựng React app rồi, nhưng bạn đã làm nó thật sự hay? </p>\n<h1>Ý tưởng</h1>\n<p>Thường thì mọi người hay dùng <code class=\"language-text\">react-router</code> trong React, phần code router thì nó sẽ như vầy</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> App<span class=\"token operator\">:</span> <span class=\"token function-variable function\">VFC</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Switch<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">\"/about\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>About <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Route<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">\"/users\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Users <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Route<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">\"/\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Home <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Route<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Switch<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Lúc mình làm Angular thì thấy cách setup routing ở Angular khá là dễ để maintain, nên đã áp thử ý tưởng đó vô React và đây là kết quả.</p>\n<p>Về cơ bản chúng ta sẽ có:</p>\n<ul>\n<li>Tất cả những chỗ cần routing trong React đều nằm chung một chỗ để dễ maintain.</li>\n<li>Routing sẽ linh hoạt hơn, có thể đặt ở đâu cũng được.</li>\n<li>Opt-in lazy loading, Suspense.</li>\n<li>Folder structure rõ hơn (cái này tuỳ có người nghĩ nó cũng vậy).</li>\n</ul>\n<h1>Dependencies:</h1>\n<ul>\n<li>react-router</li>\n<li>@loadable/component: có thể không dùng nếu không cần lazy load hoặc dùng React.lazy</li>\n</ul>\n<h1>Tạo một reusable router component</h1>\n<p>Thay vì đoạn code ở đầu, chúng ta sẽ tạo một reuseable router component và dùng component đó để routing bằng cách truyền vào một list các route và component mà nó cần render ứng với route đó. Bạn đặt tên gì cũng được, mình đặt tên nó là <code class=\"language-text\">RouterOutlet</code>.</p>\n<p>RouterOutlet.tsx</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">FC</span><span class=\"token punctuation\">,</span> Suspense <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Switch<span class=\"token punctuation\">,</span> Route<span class=\"token punctuation\">,</span> RouteProps <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-router-dom'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">RouterOutletProps</span> <span class=\"token punctuation\">{</span>\n  baseUrl<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  routes<span class=\"token operator\">:</span> RouteProps<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  fallback<span class=\"token operator\">?</span><span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span>ReactNode<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">RouteConfig</span> <span class=\"token operator\">=</span> RouteProps<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">resovePath</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>baseUrl<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>path<span class=\"token operator\">:</span> RouteProps<span class=\"token punctuation\">[</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>baseUrl <span class=\"token operator\">??</span> <span class=\"token string\">''</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>path <span class=\"token operator\">??</span> <span class=\"token string\">''</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> RouterOutlet<span class=\"token operator\">:</span> <span class=\"token constant\">FC</span><span class=\"token operator\">&lt;</span>RouterOutletProps<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> baseUrl<span class=\"token punctuation\">,</span> routes<span class=\"token punctuation\">,</span> fallback <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Suspense fallback<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>fallback <span class=\"token operator\">??</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Switch<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span>routes<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> path<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>rest <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n          <span class=\"token operator\">&lt;</span>Route <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>rest<span class=\"token punctuation\">}</span> path<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">resovePath</span><span class=\"token punctuation\">(</span>baseUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Switch<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Suspense<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Ở đây mình dùng thêm React Suspense nữa, nếu không muốn thì có thể bỏ đi nhé!</p>\n<p>Từ đây thay vì đoạn code lúc đầu chúng ta có thể dùng thế này.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> routes<span class=\"token operator\">:</span> RouteConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    path<span class=\"token operator\">:</span> <span class=\"token string\">'/users'</span><span class=\"token punctuation\">,</span>\n    component<span class=\"token operator\">:</span> <span class=\"token function\">loadable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@app/features/user'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    exact<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    path<span class=\"token operator\">:</span> <span class=\"token string\">'/posts'</span><span class=\"token punctuation\">,</span>\n    component<span class=\"token operator\">:</span> <span class=\"token function\">loadable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@app/features/post'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> App<span class=\"token operator\">:</span> <span class=\"token function-variable function\">VFC</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>RouterOutlet routes<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>routes<span class=\"token punctuation\">}</span> fallback<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>Loading<span class=\"token operator\">...</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h1>Để các router outlet ở đâu?</h1>\n<p>Có 2 hướng mình nghĩ tới đó là theo feature base hoặc gom hết lại ở một folder là <code class=\"language-text\">routers</code>.</p>\n<p>Nếu như project của bạn đang chia theo feature base thì trong mỗi folder của feature thì bạn tạo 1 cái <code class=\"language-text\">FeatureRouter</code> cho nó ví dụ:</p>\n<p>features/user/UserFeatureRouter.tsx</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\">  <span class=\"token keyword\">const</span> routes<span class=\"token operator\">:</span> RouteConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n    path<span class=\"token operator\">:</span> <span class=\"token string\">'/list'</span><span class=\"token punctuation\">,</span>\n    component<span class=\"token operator\">:</span> <span class=\"token function\">loadable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./UserList.tsx'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    exact<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    path<span class=\"token operator\">:</span> <span class=\"token string\">'/remove'</span><span class=\"token punctuation\">,</span>\n    component<span class=\"token operator\">:</span> <span class=\"token function\">loadable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./RemoveUser.tsx'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">UserFeatuerRouter</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>RouterOutlet routes<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>routes<span class=\"token punctuation\">}</span> fallback<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token operator\">&lt;</span>UserFeatureLoading<span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Sau đó bạn có thể sử dụng cái router này trong features/user/index.tsx</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">UserFeature</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>User Feature<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>UserFeatureRouter <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Hoặc bạn có thể tạo một thư mục <code class=\"language-text\">routes</code> và trong đó có tất cả các router mà bạn tạo ra trong app, mình thì ưu tiên cách trên hơn nhưng mà chuyện chia theo feature-base thì trong React cũng không phổ biến lắm nhất là những project cũ.</p>\n<p>Bài viết này chỉ có vậy thôi, chủ yếu kết hợp những cái hay của cả React và Angular với mục đích là vừa ngắn gọn, dễ hiểu như React vừa scale tốt và rõ ràng như Angular.</p>","frontmatter":{"path":"/cool-react-routing.md","title":"Routing trong React sao cho ngầu","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAByElEQVQoz31SS0sCURidhZtaRIQpOs40jjoTY2pPJatFEEEbc1GbVklUBOEiUHtANWb0QNyEmyKD1i1a+BOCfkL/oL9xOneaYgjpwuE+vu+e75z7XSmRSKAX4vH499owoMZiGOHe+BvrAek/spiuI6SqeMrn8Tg7Cz/3uhsTOb2IpV5kBlUJZNJp5Obm8JDL4XN5GVuZDNI8N0dHYXL+l/CnoiCKRqPw+Xxot9sQI2BZmGQMhQJeWKB/aAgjVG64pF5iyWvRNE0oioJisYjzszOsr63h6OQEuxMTeJ2fxzNtb3BtX16iuLoKlbmC1CtK+iHT+T4iGAgE0Gw2HWXCct/AAN4XF/GxtIRBEoxNTTmxm9tbDPv9sGjfK+pXYZqXk8kkgsGgY9miTWHLSqWQ5aU8oTJPZuHUzAwyzFVE0/gDNE+jJKEqHA6j0+mg2+2iXq+jWq3Ctm0c1mq4u79HiVbfFhZwQaLT6Wnss8hdNotr4opnm2yW7lWoaRpKpRIqlQoajYZD2mq1UC6XsbO3hwK7fMBLx7QrCG2SbI+P45zrOrFCtZr7T3/fUKW9SCTiqJVlGaFQyGmQgKgeoTWBsDsrhOzuvZa/AGW4S39+qc2qAAAAAElFTkSuQmCC","aspectRatio":2,"src":"/static/b17f2b049068979741a79588250ad8cb/05d05/featured.png","srcSet":"/static/b17f2b049068979741a79588250ad8cb/5ca18/featured.png 270w,\n/static/b17f2b049068979741a79588250ad8cb/13528/featured.png 540w,\n/static/b17f2b049068979741a79588250ad8cb/05d05/featured.png 1080w,\n/static/b17f2b049068979741a79588250ad8cb/e4d72/featured.png 1280w","sizes":"(max-width: 1080px) 100vw, 1080px"}}},"date":"2021-02-21","tags":"REACT,TYPESCRIPT","duration":5}}},"pageContext":{"mdpath":"/cool-react-routing.md","language":"en","intl":{"language":"en","languages":["en","vi"],"messages":{"home.greeting":"Hai's Corner","home.intro":"Hello, I am Hai. This is where I share my articles about Programming, Cooking and Gamming.","home.programming":"Programming","home.cooking":"Cooking","home.minutes":"{value} minutes"},"routed":false,"originalPath":"/cool-react-routing.md","redirect":true,"defaultLanguage":"en"}}},"staticQueryHashes":["4033596395"]}